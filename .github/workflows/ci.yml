name: REACT CI

on:
  pull_request:
      branches: ["main","develop"]

jobs:
    Jest:
        runs-on: [ubuntu-latest] 
        strategy:
          matrix:
            node-version: [14.x] 
        steps:
          - uses: actions/checkout@v2
          - name: Use Node.js ${{ matrix.node-version }}
            uses: actions/setup-node@v1
            with:
              node-version: ${{ matrix.node-version }}
          - name: ======== YANR INSTALL ğŸ§° ========
            run: |
              npm i -g yarn &&
              yarn install --frozen-lockfile
          - name: ======== TEST START ğŸš€ ========
            run: |
              yarn test
          - name: ======== TEST FAIL ğŸ˜¨ ========
            uses: actions/github-script@v5
            with:
              github-token: ${{secrets.GITHUB_TOKEN}}
              script: |
                const ref = "${{github.ref}}"
                const pull_number = Number(ref.split("/")[2])
                await  github.rest.issues.createComment({
                  issue_number: context.issue.number,
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  body: 'ğŸ”¥ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.'
                })
            if: failure()
          - name: ======== TEST SUCCESS ========
            uses: actions/github-script@v5
            with:
              github-token: ${{secrets.GITHUB_TOKEN}}
              script: |
                const ref = "${{github.ref}}"
                const pull_number = Number(ref.split("/")[2])
                await  github.rest.issues.createComment({
                  issue_number: context.issue.number,
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  body: 'ğŸš€ í…ŒìŠ¤íŠ¸ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤!!'
                })
            if: success()

